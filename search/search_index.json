{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SANS Cloud Security Flight Simulator Instructions","text":"<p>These setup instructions contain everything you'll need to deploy the SANS Cloud Security Flight Simulator training lab environment into your own personal cloud accounts. Make sure you use the instructions for the version of the course that you attended.</p>"},{"location":"#sec540","title":"SEC540","text":"<ul> <li>SEC540 K01 - April 2025 - TBD</li> </ul> Prior Versions <ul> <li>SEC540 J01 - before April 2025.</li> </ul>"},{"location":"#sec545","title":"SEC545","text":"<ul> <li>SEC545 K02 - April 2025 - TBD</li> </ul>"},{"location":"getting-started-k01/","title":"Range Access Instructions (J01 / K01)","text":"<p>You must complete the following steps to connect to the DevOps Server.</p>"},{"location":"getting-started-k01/#sans-cloud-security-flight-simulator-access","title":"SANS Cloud Security Flight Simulator Access","text":"<p>Complete the following steps to install the Firefox web browser on your machine, add the SEC540 root certificate, and configure the SmartProxy for accessing the SANS Cloud Security Flight Simulator environment.</p>"},{"location":"getting-started-k01/#install-firefox","title":"Install Firefox","text":"<p>Firefox is Required!</p> <p>You must use Firefox to connect to the SANS Cloud Security Flight Simulator environment. Chrome's SmartProxy extension does not support proxy authentication.</p> <ol> <li> <p>Download and install the Firefox web browser on your machine: https://www.mozilla.org/firefox.</p> </li> <li> <p>The OpenVSCode server accessible through the SANS Cloud Security Flight Simulator requires the <code>dom.events.testing.asyncClipboard</code> option to be enabled to paste commands into the embedded OpenVSCode terminal. To set this option, browse to the <code>about:config</code> URL. Then, search for the <code>dom.events.testing.asyncClipboard</code> option and double click set it to <code>true</code>.</p> <p></p> </li> </ol>"},{"location":"getting-started-k01/#install-sec540-root-certificate","title":"Install SEC540 Root Certificate","text":"<p>For TLS secured connections to the server in the SANS Cloud Security Flight Simulator, download the SANS Cloud Security CA Certificate. Then, add the CA certificate to your browser's trusted list of certificate authorities.</p> <ol> <li> <p>Download the DER Encoded SEC540 certificate and note the download location: https://sec540.com/ca</p> </li> <li> <p>Open the Firefox settings by going to Firefox &gt; Settings in the menu bar. Alternatively, you can browse to the <code>about:preferences</code> URL.</p> </li> <li> <p>Click \"Privacy &amp; Security\" in the left hand menu and scroll down to the \"Certificates\" section.</p> <p></p> </li> <li> <p>Click the View Certificates button.</p> </li> <li> <p>In the Certificate Manager window, select the Authorities tab, and click the Import... button.</p> <p></p> </li> <li> <p>Browse to the directory that you downloaded the <code>sec540-ca.der</code> file and select the certificate.</p> </li> <li> <p>Select the Trust this CA to identify websites trust settings option and press OK to import the certificate.</p> <p></p> </li> <li> <p>In the Certificate Manager window, press OK to close the certificate settings window.</p> <p></p> </li> </ol>"},{"location":"getting-started-k01/#install-smartproxy","title":"Install SmartProxy","text":"<p>The SANS Cloud Security Flight Simulator server(s) is accessible through a SOCK5 proxy listening on port 54000. Open Firefox and install the SmartProxy extension (https://addons.mozilla.org/en-US/firefox/addon/smartproxy/). If you are not familiar with Firefox extensions, follow the steps below to install the SmartProxy extension.</p> <ol> <li> <p>From the Firefox preferences screen, select the Extensions &amp; Themes option in the left navigation menu. Alternatively, you can browse to the <code>about:addons</code> URL.</p> <p></p> </li> <li> <p>Use the Find more add-ons field to search for the SmartProxy extension.</p> <p></p> </li> <li> <p>Select the SmartProxy add-on to open to the SmartProxy installation page.</p> <p></p> </li> <li> <p>Click the Add to Firefox button to start the installation.</p> <p></p> </li> <li> <p>Click the Add button in the Add SmartProxy? popup window.</p> <p></p> </li> <li> <p>Check the Allow this extension to run in Private Windows option.</p> <p></p> </li> <li> <p>Click the Okay button to complete the installation.</p> </li> <li> <p>The SmartProxy extension is now installed and can be found in the top right-hand corner of the browser.</p> <p></p> </li> <li> <p>By default, the extension is not pinned to menu bar. You can pin the extension by right clicking on the extension and selecting Pin to Toolbar for convenience.</p> <p></p> </li> </ol>"},{"location":"getting-started-k01/#import-smartproxy-configuration","title":"Import SmartProxy Configuration","text":"<ol> <li> <p>In Firefox, select the SmartProxy extension and press the Settings button.</p> <p></p> </li> <li> <p>In the SmartProxy Settings, select the Backup/Restore button.</p> <p></p> </li> <li> <p>Select the Restore Backup button to import the SmartProxy configuration file.</p> <p></p> </li> <li> <p>Browse to the directory that you ran Terraform from and select the SmartProxy configuration file.</p> </li> <li> <p>After restoring the backup, the SEC540-Range SmartProxy configuration is now available to use. All traffic to sans.labs and dm.paper will be sent through the SOCKS5 proxy to your DevOps server.</p> <p></p> </li> <li> <p>Use the SmartProxy extension to select the SEC540-Range proxy.</p> <p></p> </li> <li> <p>Firefox is now connected to the SANS Cloud Security Flight Simulator environment! All class-relevant traffic will be sent to your DevOps server.</p> </li> <li> <p>In Firefox, browse to the Lab Instructions Workbook and OpenVSCode Server.</p> </li> <li> <p>Run the following commands in the OpenVSCode terminal to update the lab instructions and apply any applicable errata patches.</p> <pre><code>workbook-update\nvirtual-machine-update\n</code></pre> </li> </ol>"},{"location":"getting-started-l01/","title":"SEC540 Lab Setup Guide (L01)","text":""},{"location":"getting-started-l01/#before-you-arrive-or-travel-to-class","title":"Before You Arrive or Travel to Class","text":"<p>You must complete several steps before you arrive or travel to class.  For those students attending a live class event, this means completing the setup process before you arrive at the venue.</p> <p>The following sections of this document cover these steps:</p> <ol> <li>Downloading Course Materials: Follow the guidance at https://sansurl.com/downloading-course-materials to access and download your course materials.</li> <li>SANS MyLabs Access: Some materials for your course are dynamically generated. Follow the steps below to access this material in the MyLabs section of your sans.org account.</li> <li>Lab Range Provisioning: Review the guidance below to launch the SEC540 lab environment range, and download your lab range configuration files.</li> <li>SANS Cloud Security Flight Simulator Access: Follow the steps below to authenticate to the Cloud Security Flight Simulator and access the services running on the DevOps server.</li> <li>SEC540 Lab Instructions: Follow the steps below to connect to the DevOps server, update the lab instructions, and apply the errata patches to ensure you are working from the most recent instructions available.</li> <li>SEC540 Cloud Configuration: Follow the steps below to complete the relevant environment configuration for your selected cloud provider.</li> </ol>"},{"location":"getting-started-l01/#2-sans-mylabs-access","title":"2. SANS MyLabs Access","text":"<p>To access the SANS Cloud Security Flight Simulator, sign in to https://sans.org/account and view the My Labs screen. Expand the SEC540 section and read through the details. For step-by-step instructions, review the guidance on the SANS website at https://sansurl.com/accessing-mylabs-content.</p>"},{"location":"getting-started-l01/#3-lab-range-provisioning","title":"3. Lab Range Provisioning","text":"<p>OnDemand Student Access</p> <p>Students taking SEC540 OnDemand will see a dynamic provisioning option on their SANS My Labs page. Students will need to press the Launch button to provision their lab range. After launching the simulator, the range configuration files will be available to download within 30 minutes.</p> <p>Live Students Access</p> <p>Students taking SEC540 at a live event (in person or online) will automatically have their lab range provisioned 24 hours before the event starts. Before the class starts, browse to the SANS My Labs page to download the range configuration files.</p> <p>From the My Labs screen, scroll to the Downloadable Files table and locate the configuration files for your lab range.</p> <p></p> <p>Download each of the following files and move them into a noted directory location on your host machine:</p> <ul> <li> <p>sans-sec540-range-access.txt - (Required) The primary configuration file for your lab range that includes your unique range URL, expiration time, username, and password for authenticating to the SANS Cloud Security Flight Simulator. After authentication, you can browse and authenticate (if needed) to the other services hosted on the range's DevOps server including the lab instructions, OpenVSCode server, GitLab, Vault, Keycloak, Moonlight Monitoring, and Defect Dojo.</p> </li> <li> <p>aws-login-info.txt - (Required) Contains instructions for signing in to a time-limited SANS managed AWS account using the AWS Web Console.You will use this file during the lab setup if you choose to use the AWS cloud provider for the course.</p> </li> <li> <p>aws-iam-user-credentials.json - (Optional) Contains programmatic access credentials for configuring the DevOps server to authenticate to the SANS managed AWS account. These credentials have already been placed on the DevOps server in the ~/config/aws-config.json file. You should not need to use this file, but keep it as a backup just in case you need to reconfigure the credentials at any point.</p> </li> <li> <p>azure-login-info.txt - (Required) Contains instructions for signing in to a time-limited SANS managed Azure subscription using the Azure Web portal. You will use this file during the lab setup if you choose to use the Azure cloud provider for the course.</p> </li> <li> <p>azure-service-principal-config.json - (Optional) Contains programmatic service principal credentials for configuring the DevOps server to authenticate to the SANS managed Azure subscription. These credentials have already been placed on the DevOps server in the ~/config/azure-config.json file. You should not need to use this file, but keep it as a backup just in case you need to reconfigure the credentials at any point.</p> </li> </ul>"},{"location":"getting-started-l01/#4-sans-cloud-security-flight-simulator-access","title":"4. SANS Cloud Security Flight Simulator Access","text":"<p>Open the sans-sec540-range-access.txt configuration file you downloaded in the previous section. Find the SEC540 Range Access Instructions at the top of the file, which includes the Range URL, Username, Password, and Expiration.</p> <p>Example SEC540 Range Access Instructions</p> <pre><code>SEC540 Range Access Instructions\n\nYour SEC540 Lab Range is hosted on the unique-identifier.domain.tld domain.\nTo access the range services, you need to authenticate to the range with the\nfollowing credentials:\n\nRange URL: https://range.unique-identifier.domain.tld\nRange Username: range-unique-identifier\nRange Password: unique-range-password\nRange Expiration: end date and time\n</code></pre> <p>When accessing the Cloud Security Flight Simulator, we recommend opening a browser on your host machine (Chrome or Firefox) and using a private (or incognito) browsing session to ensure the range services do not interfere with your existing profiles and sessions. In the private browsing session, navigate to the Range URL provided in the configuration file (<code>https://range.unique-identifier.domain.tld</code>). You should see the SANS Cloud Security Flight Simulator login page.</p> <p></p> <p>Enter the Range Username and Range Password to authenticate to the SANS Cloud Security Flight Simulator. After successfully authenticating, you will be redirected to the lab instructions, which are hosted on the DevOps server. Observe that the top navigation bar includes links to the other services hosted on the DevOps server including the GitLab, VSCode, Vault, and many other services.</p> <p></p>"},{"location":"getting-started-l01/#5-sec540-lab-instructions","title":"5. SEC540 Lab Instructions","text":"<p>Before getting started, you need to update the lab instructions and apply any available patches to the DevOps server. To do this, browse to the OpenVSCode Server running on the DevOps server and open a new Terminal session.</p> <ol> <li> <p>Use the top navigation menu's VS Code link in the lab instructions to open a new browser tab and navigate to the OpenVSCode Server running on the DevOps server. The URL can also be found in the sans-sec540-range-access.txt configuration file you downloaded earlier.</p> </li> <li> <p>If you receive a prompt asking if you trust the authors of the files in this workspace, select Yes, I trust the authors.</p> <p></p> </li> <li> <p>If you receive a prompt asking if you reload the OpenVSCode server, select Reload.</p> <p></p> </li> <li> <p>If you are prompted to select a color theme, select one of the color themes (1) and then press the Mark Done button.</p> <p></p> </li> <li> <p>Use the hamburger button (\u2261) in the top left corner to find the New Terminal menu item. When prompted, select the code directory to open a new terminal session in the /home/student/code directory.</p> <p></p> </li> <li> <p>Observe the OpenVSCode server displays an embedded Terminal in the bottom of the window.</p> <p></p> </li> <li> <p>When copying and pasting commands into the OpenVSCode terminal, the browsers may need permission to access your host machine's clipboard.</p> <ul> <li> <p>In Firefox, the <code>dom.events.testing.asyncClipboard</code> option needs to be enabled to paste commands into the embedded OpenVSCode terminal. To set this option, browse to the <code>about:config</code> URL. Then, search for the <code>dom.events.testing.asyncClipboard</code> option and double click set it to <code>true</code>.</p> <p></p> </li> <li> <p>In Chrome, when prompted with a popup at the top of the browser window, press the Allow button.</p> <p></p> </li> </ul> </li> <li> <p>Run the following command in the Terminal to update the lab instructions to the most recent version.</p> <pre><code>workbook-update\n</code></pre> <p>Example Output</p> <pre><code>Starting workbook update...\n31c1512 (grafted, HEAD -&gt; main, origin/main, origin/HEAD) Built from @ b0420e67684777babaff981eb538943314a26dd5\nWorkbook update complete!\n</code></pre> </li> <li> <p>Run the following command to apply the available updates to the DevOps server. These are published as needed when cloud service or DevOps tool changes break the lab environment.</p> <pre><code>virtual-machine-update\n</code></pre> <p>Important</p> <p>You must apply all virtual machine updates for the labs to work properly.</p> </li> <li> <p>When the virtual machine updates have finished applying, you can leave the browser tab running your OpenVSCode session open. You will use this again in Lab 1.0 to configure the cloud credentials.</p> </li> </ol>"},{"location":"getting-started-l01/#6-sec540-environment-configuration","title":"6. SEC540 Environment Configuration","text":"<p>SEC540's lab environment focuses on cloud native technologies including GitLab CI/CD, Vault, Terraform, Kubernetes, Sigstore, Trivy, Open Policy Agent, Gatekeeper, Keycloak, Kong API Gateway, Checkov, Semgrep, Trivy, Prowler, Defect Dojo, Grafana, Open Telemetry, and Cloud Custodian. These technologies are cloud agnostic and used in the lab environment regardless of which cloud provider you choose. However, the configuration and implementation details of each technology will vary slightly depending on whether you target the Amazon Web Services (AWS) or Microsoft Azure cloud providers.</p> <p>Students are expected to choose ONE cloud provider and work through the applicable labs during the course. Lab time estimates are based on selecting a single cloud provider. After deciding which cloud to use, you will configure the DevOps server to use a SANS managed time-limited AWS or Azure account to host the lab infrastructure.</p> <p>The following sections should help guide your decision on which cloud provider to choose:</p>"},{"location":"getting-started-l01/#aws-cloud","title":"AWS Cloud","text":"<p>Deploys workloads using Terraform for Infrastructure as Code, Amazon Elastic Kubernetes Service (EKS) for container orchestration, and other services such as IAM, EC2, S3, and Lambda.</p>"},{"location":"getting-started-l01/#azure-cloud","title":"Azure Cloud","text":"<p>Deploys workloads using Terraform for Infrastructure as Code, Azure Kubernetes Service (AKS) for container orchestration, and other services such as Entra ID, Azure Virtual Machines, and Azure Storage.</p>"},{"location":"getting-started-l01/#hands-on-lab-instructions","title":"Hands-on Lab Instructions","text":"<p>In your browser, go back to the lab instructions tab and use the Hands-on Labs top navigation menu item to view the Lab List page.</p> <p></p> <p>Depending on the cloud provider you selected, select the appropriate Getting Started lab and complete the instructions to finish the lab environment setup.</p> <ul> <li> <p>AWS: Complete the Lab 1.0 - AWS steps in the lab instructions to finish configuring the DevOps server to use the SANS managed AWS cloud account.</p> </li> <li> <p>Azure: Complete the Lab 1.0 - Azure steps in the lab instructions to finish configuring the DevOps server to use the SANS managed Azure cloud account.</p> </li> </ul>"},{"location":"j01/","title":"SANS SEC540 Cloud Security Simulator Setup Guide (J01)","text":"<p>SEC540 students can follow these instructions to build the labs in their personal AWS and Azure accounts. Doing so allows students to complete the labs after access to the SANS provisioned accounts is expired. Cost estimates vary by cloud provider:</p> <ul> <li> <p>AWS free tier eligible accounts are expected to cost roughly $10 USD per day for the AWS resources (including the DevOps server). Make sure you stop the DevOps server when you are not using it.</p> </li> <li> <p>Azure Pay as You Go (PAYG) subscriptions are expected to cost roughly $20 USD per day for the Azure resources.</p> </li> </ul> <p>To limit costs, please make sure to run the Lab 5.4: Tear Down script in the electronic workbook when you are not using the lab environment.</p> <p>YOUR Financial Responsibility</p> <p>When running the Cloud Security Flight Simulator and performing the corresponding labs in your personal AWS / Azure environments, YOU are responsible for all costs.</p>"},{"location":"j01/#devops-server-deployment","title":"DevOps Server Deployment","text":""},{"location":"j01/#requirements","title":"Requirements","text":"<ul> <li>Provided by you:<ul> <li>AWS personal account with administrator credentials</li> <li>Terraform 1.9 or later</li> <li>AWS CLI</li> </ul> </li> <li>Provided by the SEC540 instructor or OnDemand SME:<ul> <li>DevOps server AMI shared to your personal AWS account</li> <li>Commands to set the Terraform variables and apply the template</li> </ul> </li> </ul>"},{"location":"j01/#step-by-step-instructions","title":"Step by Step Instructions","text":"<ol> <li> <p>Configure your AWS CLI with administrator credentials for your AWS Account.</p> <pre><code>aws configure\n</code></pre> </li> <li> <p>Create a new working directory for running the Terraform deployment.</p> <pre><code>mkdir ~/sec540\ncd ~/sec540\n</code></pre> </li> <li> <p>Download the sec540-j01.tf launch template (e.g. sec540-j01-ami.tf) into the <code>~/sec540</code> directory.</p> </li> <li> <p>After sharing the AMI with your personal AWS account, the instructor or OnDemand SME will give you the commands to set the required Terraform variables and apply the template. Run those commands in the <code>~/sec540</code> directory.</p> </li> <li> <p>The <code>terraform apply</code> command will take a few minutes to complete. Once it is finished, you will see the following:</p> </li> <li> <p>The <code>environment_summary</code> output contains the information you need to connect to the DevOps server.</p> </li> <li> <p>SmartProxy Config - The name of the SmartProxy configuration file created by Terraform in the <code>~/sec540</code> directory.</p> </li> <li> <p>SSH + SOCKS Connect Command - The command to connect to the DevOps server using SSH and the SOCKS proxy using the private key created by Terraform in the <code>~/sec540</code> directory.</p> <pre><code>Apply complete! Resources: 16 added, 0 changed, 0 destroyed.\n\nOutputs:\n\nenvironment_summary = &lt;&lt;END_SUMMARY\nLatest AMI:  ami-01234567890123456 - sans-sec540-j01.24.1.123\nRunning AMI: ami-01234567890123456\nPublic IP:   18.227.81.85\n\nLocal IP:          11.222.333.444\nAllow CIDR:        11.222.333.444/32\n\nProxy Pass:        informally_typically_humble_squid\nSmartProxy Config: SmartProxy-frank-man.json\n\nSSH + SOCKS Connect Command\n\n    ssh -i frank-man.pem -D 54561 student@18.227.81.85\n\nEND_SUMMARY\n</code></pre> </li> <li> <p>Follow the Range Access Instructions to install the DevOps server's CA certificate, configure the SmartProxy extension, and connect to the DevOps server.</p> </li> </ol>"},{"location":"j01/#aws-devsecops-iam-user","title":"AWS DevSecOps IAM User","text":"<p>To deploy the lab infrastructure to AWS, you need to create a new <code>devsecops</code> IAM user. The easiest to to set permissions is by attaching the AdministratorAccess policy. Our recommendation is to use a permission boundary on this IAM user to restrict access to the services not used in the AWS labs. Then, create a new pair of access keys for authenticating the DevOps server to your account.</p>"},{"location":"j01/#requirements_1","title":"Requirements","text":"<ul> <li>Provided by you:</li> <li>AWS personal account with administrator credentials</li> </ul>"},{"location":"j01/#step-by-step-instructions_1","title":"Step by Step Instructions","text":"<ol> <li> <p>Log into the AWS Console using your personal administrator account.</p> </li> <li> <p>See the Creating an IAM user in your AWS account documentation to create a new <code>devsecops</code> user.</p> </li> <li> <p>See the Adding permissions to a user (console) documentation to attach the <code>AdministratorAccess</code> policy.</p> </li> <li> <p>See the Managing access keys for IAM users documentation to create a new pair of access keys for the <code>devsecops</code> user.</p> </li> <li> <p>Follow the Lab 1.0 - AWS Cloud Account Setup instructions in the electronic workbook to configure the DevOps server's AWS Command Line Interface (CLI).</p> </li> </ol>"},{"location":"j01/#azure-service-principal","title":"Azure Service Principal","text":"<p>To deploy the lab infrastructure to Azure, you need to create a new Azure Service Principal for authenticating the DevOps server to your Azure subscription.</p>"},{"location":"j01/#requirements_2","title":"Requirements","text":"<ul> <li>Provided by you:</li> <li>Azure Pay as You Go (PAYG) subscription with owner permissions</li> </ul>"},{"location":"j01/#step-by-step-instructions_2","title":"Step by Step Instructions","text":"<ol> <li> <p>Log into the Azure Portal using your personal administrator account.</p> </li> <li> <p>Follow the Create a Microsoft Entra application and service principal that can access resources documentation to create a new <code>devsecops</code> Azure Service Principal. The service principal will need the following API permissions:</p> </li> <li> <p>Use the Microsoft Graph option to add the Application.ReadWrite.All application permission set.</p> </li> <li> <p>On the Configured permissions screen, press Grant admin consent for Default Directory.</p> </li> <li> <p>Follow the Set up authetication option 3 documentation to create a new client secret for the <code>devsecops</code> Azure Service Principal.</p> </li> <li> <p>Follow the Assign a user as an administrator of an Azure subscription documentation to assign the <code>devsecops</code> Azure Service Principal as an Owner of your Azure subscription.</p> </li> <li> <p>Follow the Lab 1.0 - Azure Cloud Account Setup instructions in the electronic workbook to populate the <code>~/.azconfigvars</code> file with the <code>devsecops</code> client id, client secret, tenant id, and subscription id. Then, complete the remaining Azure Command Line Interface (CLI) steps.</p> </li> </ol>"},{"location":"j01/#clean-up","title":"Clean Up","text":"<ul> <li> <p>When you are finished with the labs, run the Lab 5.4: Tear Down script in the electronic workbook to remove the lab infrastructure from your AWS and Azure accounts.</p> </li> <li> <p>Then use the same Terraform commands you used to create the DevOps server, except change the last command from <code>terraform apply</code> to <code>terraform destroy</code>. This will remove the DevOps server and the SmartProxy configuration file from your AWS account.</p> </li> </ul>"},{"location":"k01/","title":"SANS SEC540 Cloud Security Simulator Setup Guide (K01)","text":"<p>SEC540 students can follow these instructions to build the labs in their personal AWS and Azure accounts. Doing so allows students to complete the labs after access to the SANS provisioned accounts is expired. Cost estimates vary by cloud provider:</p> <ul> <li> <p>AWS free tier eligible accounts are expected to cost roughly $10 USD per day for the AWS resources (including the DevOps server). Make sure you stop the DevOps server when you are not using it.</p> </li> <li> <p>Azure Pay as You Go (PAYG) subscriptions are expected to cost roughly $20 USD per day for the Azure resources.</p> </li> </ul> <p>To limit costs, please make sure to run the Lab 5.4: Tear Down script in the electronic workbook when you are not using the lab environment.</p> <p>YOUR Financial Responsibility</p> <p>When running the Cloud Security Flight Simulator and performing the corresponding labs in your personal AWS / Azure environments, YOU are responsible for all costs.</p>"},{"location":"k01/#devops-server-deployment","title":"DevOps Server Deployment","text":""},{"location":"k01/#requirements","title":"Requirements","text":"<ul> <li>Provided by you:<ul> <li>AWS personal account with administrator credentials</li> <li>Terraform 1.9 or later</li> <li>AWS CLI</li> </ul> </li> <li>Provided by the SEC540 instructor or OnDemand SME:<ul> <li>DevOps server AMI shared to your personal AWS account</li> <li>Commands to set the Terraform variables and apply the template</li> </ul> </li> </ul>"},{"location":"k01/#step-by-step-instructions","title":"Step by Step Instructions","text":"<ol> <li> <p>Configure your AWS CLI with administrator credentials for your AWS Account.</p> <pre><code>aws configure\n</code></pre> </li> <li> <p>Create a new working directory for running the Terraform deployment.</p> <pre><code>mkdir ~/sec540\ncd ~/sec540\n</code></pre> </li> <li> <p>Download the sec540-k01.tf launch template (e.g. sec540-k01-ami.tf) into the <code>~/sec540</code> directory.</p> </li> <li> <p>After sharing the AMI with your personal AWS account, the instructor or OnDemand SME will give you the commands to set the required Terraform variables and apply the template. Run those commands in the <code>~/sec540</code> directory.</p> </li> <li> <p>The <code>terraform apply</code> command will take a few minutes to complete. Once it is finished, you will see the following:</p> <ul> <li> <p>The <code>environment_summary</code> output contains the information you need to connect to the DevOps server.</p> </li> <li> <p>SmartProxy Config - The name of the SmartProxy configuration file created by Terraform in the <code>~/sec540</code> directory.</p> </li> <li> <p>SSH + SOCKS Connect Command - The command to connect to the DevOps server using SSH and the SOCKS proxy using the private key created by Terraform in the <code>~/sec540</code> directory.</p> </li> </ul> <pre><code>Apply complete! Resources: 16 added, 0 changed, 0 destroyed.\n\nOutputs:\n\nenvironment_summary = &lt;&lt;EOT\n  Latest AMI:  ami-06cb88e1e8c394247 - sans-sec540-k01.25.1.0\n  Running AMI: ami-06cb88e1e8c394247\n  Public IP:   3.15.0.118\n\n  Local IP:          71.34.29.101\n  Allow CIDR:        71.34.29.101/32\n\n  Proxy Pass:        intensely_luckily_bursting_pelican\n  SmartProxy Config: SmartProxy-enjoyed-crawdad.json\n\n  SSH + SOCKS Connect Command\n\n      ssh -i enjoyed-crawdad.pem -D 54640 student@3.15.0.118\n\n  SOCKS5 URI: socks5://student:intensely_luckily_bursting_pelican@3.15.0.118:54640\n\nEOT\n</code></pre> </li> <li> <p>Follow the Range Access Instructions to install the DevOps server's CA certificate, configure the SmartProxy extension, and connect to the DevOps server.</p> </li> </ol>"},{"location":"k01/#aws-devsecops-iam-user","title":"AWS DevSecOps IAM User","text":"<p>To deploy the lab infrastructure to AWS, you need to create a new <code>devsecops</code> IAM user. The easiest to to set permissions is by attaching the AdministratorAccess policy. Our recommendation is to use a permission boundary on this IAM user to restrict access to the services not used in the AWS labs. Then, create a new pair of access keys for authenticating the DevOps server to your account.</p>"},{"location":"k01/#requirements_1","title":"Requirements","text":"<ul> <li>Provided by you:<ul> <li>AWS personal account with administrator credentials</li> </ul> </li> </ul>"},{"location":"k01/#step-by-step-instructions_1","title":"Step by Step Instructions","text":"<ol> <li> <p>Log into the AWS Console using your personal administrator account.</p> </li> <li> <p>See the Creating an IAM user in your AWS account documentation to create a new <code>devsecops</code> user.</p> </li> <li> <p>See the Adding permissions to a user (console) documentation to attach the <code>AdministratorAccess</code> policy.</p> </li> <li> <p>See the Managing access keys for IAM users documentation to create a new pair of access keys for the <code>devsecops</code> user.</p> </li> <li> <p>Follow the Lab 1.0 - AWS Cloud Account Setup instructions in the electronic workbook to configure the DevOps server's AWS Command Line Interface (CLI).</p> </li> </ol>"},{"location":"k01/#azure-service-principal","title":"Azure Service Principal","text":"<p>To deploy the lab infrastructure to Azure, you need to create a new Azure Service Principal for authenticating the DevOps server to your Azure subscription.</p>"},{"location":"k01/#requirements_2","title":"Requirements","text":"<ul> <li>Provided by you:<ul> <li>Azure Pay as You Go (PAYG) subscription with owner permissions</li> </ul> </li> </ul>"},{"location":"k01/#step-by-step-instructions_2","title":"Step by Step Instructions","text":"<ol> <li> <p>Log into the Azure Portal using your personal administrator account.</p> </li> <li> <p>Follow the Create a Microsoft Entra application and service principal that can access resources documentation to create a new <code>devsecops</code> Azure Service Principal. The service principal will need the following API permissions:</p> <ul> <li> <p>Use the Microsoft Graph option to add the Application.ReadWrite.All application permission set.</p> </li> <li> <p>On the Configured permissions screen, press Grant admin consent for Default Directory.</p> </li> </ul> </li> <li> <p>Follow the Set up authetication option 3 documentation to create a new client secret for the <code>devsecops</code> Azure Service Principal.</p> </li> <li> <p>Follow the Assign a user as an administrator of an Azure subscription documentation to assign the <code>devsecops</code> Azure Service Principal as an Owner of your Azure subscription.</p> </li> <li> <p>Follow the Lab 1.0 - Azure Cloud Account Setup instructions in the electronic workbook to populate the <code>~/.azconfigvars</code> file with the <code>devsecops</code> client id, client secret, tenant id, and subscription id. Then, complete the remaining Azure Command Line Interface (CLI) steps.</p> </li> </ol>"},{"location":"k01/#clean-up","title":"Clean Up","text":"<ul> <li> <p>When you are finished with the labs, run the Lab 5.4: Tear Down script in the electronic workbook to remove the lab infrastructure from your AWS and Azure accounts.</p> </li> <li> <p>Then use the same Terraform commands you used to create the DevOps server, except change the last command from <code>terraform apply</code> to <code>terraform destroy</code>. This will remove the DevOps server and the SmartProxy configuration file from your AWS account.</p> </li> </ul>"},{"location":"sec545-k02/","title":"SANS SEC545 Cloud Security Simulator Setup Guide (K02)","text":"<p>SEC545 students can follow these instructions to build the labs in their personal AWS accounts. Doing so allows students to complete the labs after access to the SANS provisioned accounts is expired.</p> <ul> <li>AWS free tier eligible accounts are expected to cost roughly $30 USD per day for the AWS resources (including the DevOps server). Make sure you tear down the environment when you are not using it.</li> </ul> <p>To limit costs, please make sure to run the Tear Down script (<code>~/code/genaiapp/destroy_lab.sh</code>) when you are not using the lab environment.</p> <p>YOUR Financial Responsibility</p> <p>When running the Cloud Security Flight Simulator and performing the corresponding labs in your personal AWS / Azure environments, YOU are responsible for all costs.</p>"},{"location":"sec545-k02/#devops-server-deployment","title":"DevOps Server Deployment","text":""},{"location":"sec545-k02/#requirements","title":"Requirements","text":"<ul> <li>Details found in Course Materials Downloads \"Lab Setup Instructions\" guide:<ul> <li>Firefox + SmartProxy (by Salar K)</li> <li>SANS Cloud Security CA Certificate</li> </ul> </li> <li>Provided by you:<ul> <li>AWS personal account with administrator credentials</li> <li>OpenAI API Key</li> <li>SerpAPI Key</li> <li>Terraform 1.10 or later</li> <li>AWS CLI</li> </ul> </li> <li>Provided by the SEC545 instructor or OnDemand SME:<ul> <li>DevOps server AMI shared to your personal AWS account</li> <li>Commands to set the Terraform variables and apply the template</li> </ul> </li> </ul>"},{"location":"sec545-k02/#step-by-step-instructions","title":"Step by Step Instructions","text":"<ol> <li> <p>Configure your AWS CLI with administrator credentials for your AWS Account.</p> <pre><code>aws configure\n</code></pre> </li> <li> <p>Create a new working directory for running the Terraform deployment.</p> <pre><code>mkdir ~/sec545\ncd ~/sec545\n</code></pre> </li> <li> <p>Download the sec545-k02.tf launch template (e.g. sec545-k02-ami.tf) into the <code>~/sec545</code> directory.</p> </li> <li> <p>After sharing the AMI with your personal AWS account, the instructor or OnDemand SME will give you the commands to set the required Terraform variables and apply the template. Run those commands in the <code>~/sec545</code> directory.</p> </li> <li> <p>The <code>terraform apply</code> command will take a few minutes to complete. Once it is finished, you will see the following:</p> <ul> <li> <p>The <code>environment_summary</code> output contains the information you need to connect to the DevOps server.</p> </li> <li> <p>SmartProxy Config - The name of the SmartProxy configuration file created by Terraform in the <code>~/sec545</code> directory.</p> </li> <li> <p>SSH + SOCKS Connect Command - The command to connect to the DevOps server using SSH and the SOCKS proxy using the private key created by Terraform in the <code>~/sec545</code> directory.</p> </li> </ul> <pre><code>Apply complete! Resources: 16 added, 0 changed, 0 destroyed.\n\nOutputs:\n\nenvironment_summary = &lt;&lt;EOT\n  Latest AMI:  ami-06cb88e1e8c394247 - sans-sec545-k02.25.1.0\n  Running AMI: ami-06cb88e1e8c394247\n  Public IP:   3.15.0.118\n\n  Local IP:          71.34.29.101\n  Allow CIDR:        71.34.29.101/32\n\n  Proxy Pass:        intensely_luckily_bursting_pelican\n  SmartProxy Config: SmartProxy-enjoyed-crawdad.json\n\n  SSH + SOCKS Connect Command\n\n      ssh -i enjoyed-crawdad.pem -D 54640 student@3.15.0.118\n\nEOT\n</code></pre> </li> <li> <p>Follow the course Lab Setup Instructions guide to install the DevOps server's CA certificate, configure the SmartProxy extension, and connect to the DevOps server.</p> </li> </ol>"},{"location":"sec545-k02/#aws-student-iam-user","title":"AWS student IAM User","text":"<p>To deploy the lab infrastructure to AWS, you need to create a new <code>student</code> IAM user. The easiest to to set permissions is by attaching the AdministratorAccess policy. Our recommendation is to use a permission boundary on this IAM user to restrict access to the services not used in the AWS labs. Then, create a new pair of access keys for authenticating the DevOps server to your account.</p>"},{"location":"sec545-k02/#requirements_1","title":"Requirements","text":"<ul> <li>Provided by you:<ul> <li>AWS personal account with administrator credentials</li> </ul> </li> </ul>"},{"location":"sec545-k02/#step-by-step-instructions_1","title":"Step by Step Instructions","text":"<ol> <li> <p>Log into the AWS Console using your personal administrator account.</p> </li> <li> <p>See the Creating an IAM user in your AWS account documentation to create a new <code>student</code> user.</p> </li> <li> <p>See the Adding permissions to a user (console) documentation to attach the <code>AdministratorAccess</code> policy.</p> </li> <li> <p>See the Managing access keys for IAM users documentation to create a new pair of access keys for the <code>student</code> user.</p> </li> <li> <p>Follow the Lab 1.0 - AWS Cloud Account Setup instructions in the electronic workbook to configure the DevOps server's AWS Command Line Interface (CLI).</p> </li> </ol>"},{"location":"sec545-k02/#clean-up","title":"Clean Up","text":"<ul> <li> <p>When you are finished with the labs, run the ~/code/genaiapp/destroy_lab.sh script to remove the lab infrastructure from your AWS account.</p> </li> <li> <p>Then use the same Terraform commands you used to create the DevOps server, except change the last command from <code>terraform apply</code> to <code>terraform destroy</code>. This will remove the DevOps server and the SmartProxy configuration file from your AWS account.</p> </li> </ul>"}]}